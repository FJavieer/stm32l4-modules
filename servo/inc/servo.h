/******************************************************************************
 *	servo.h								      *
 *	2018/dec/17							      *
 ******************************************************************************/


/******************************************************************************
 ******* include guard ********************************************************
 ******************************************************************************/
# ifndef		SERVO_H
	# define	SERVO_H


/******************************************************************************
 ******* headers **************************************************************
 ******************************************************************************/
/* Standard C ----------------------------------------------------------------*/
	#include <stdint.h>

/* Drivers -------------------------------------------------------------------*/
/* libalx --------------------------------------------------------------------*/
/* STM32L4 modules -----------------------------------------------------------*/


/******************************************************************************
 ******* macros ***************************************************************
 ******************************************************************************/
	# define	SERVO_ANGLE_MIN			(-90)
	# define	SERVO_ANGLE_MAX			(90)


/******************************************************************************
 ******* enums ****************************************************************
 ******************************************************************************/
	enum	Servo_Saturation {
		SERVO_SATURATION_OK = 0,
		SERVO_SATURATION_NEG = -1,
		SERVO_SATURATION_POS = 1
	};

	enum	Servo_Sx {
		SERVO_S1,
		SERVO_S2,
		SERVO_S3,
		SERVO_S4,

		SERVO_QTY
	};


/******************************************************************************
 ******* structs **************************************************************
 ******************************************************************************/


/******************************************************************************
 ******* variables ************************************************************
 ******************************************************************************/


/******************************************************************************
 ******* functions ************************************************************
 ******************************************************************************/
	/**
	 * @brief	Init servo s1 in PA15 using TIM2_CH1
	 *		Sets global variable 'error'
	 * @return	None
	 */
void	servo_s1_init		(void);
	/**
	 * @brief	Init servo s2 in PA1 using TIM2_CH2
	 *		Sets global variable 'error'
	 * @return	None
	 */
void	servo_s2_init		(void);
	/**
	 * @brief	Init servo s3 in PB10 using TIM2_CH3
	 *		Sets global variable 'error'
	 * @return	None
	 */
void	servo_s3_init		(void);
	/**
	 * @brief	Init servo s4 in PB11 (GPIOB, GPIO_PIN_11)
	 *		Sets global variable 'error'
	 * @return	None
	 */
void	servo_s4_init		(void);

	/**
	 * @brief	Set servo position
	 *		Sets global variable 'error'
	 * @param	position:	position (deg)
	 *			valid range: [-90, 90]
	 * @return	Error
	 */
int	servo_sX_position_set	(float position, int8_t servo);

	/**
	 * @brief	Get servo position
	 *		Sets global variable 'error'
	 * @param	*position:	position (deg)
	 * @return	Error
	 */
int	servo_sX_position_get	(float *position, int8_t servo);

	/**
	 * @brief	Stop servos
	 * @return	None
	 */
void	servo_sALL_stop		(void);


/******************************************************************************
 ******* include guard ********************************************************
 ******************************************************************************/
# endif			/* servo.h */


/******************************************************************************
 ******* end of file **********************************************************
 ******************************************************************************/
